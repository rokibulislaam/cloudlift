FROM --platform=linux/amd64 python:3.11.10-alpine3.20

RUN apk add --no-cache \
    bash \
    build-base \
    ca-certificates \
    curl \
    gcc \
    git \
    libc-dev \
    libffi-dev \
    libgcc \
    make \
    musl-dev \
    openssl \
    openssl-dev \
    zlib-dev

ARG PYINSTALLER_TAG=v6.10.0
ENV PYINSTALLER_TAG=$PYINSTALLER_TAG

RUN git clone --branch $PYINSTALLER_TAG --depth 1 https://github.com/pyinstaller/pyinstaller.git /tmp/pyinstaller && \
    cd /tmp/pyinstaller/bootloader && \
    python ./waf configure all && \
    pip install ..